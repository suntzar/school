<!DOCTYPE html>
<html lang="pt-BR" data-bs-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de Alunos - Escola Infantil</title>

    <!-- Bootstrap 5.3 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <style>
        /* Variáveis CSS para a paleta de cores pastel */
        :root {
            --primary-pastel: #8ECDDD; /* Azul claro */
            --success-pastel: #A2D991; /* Verde claro */
            --info-pastel: #FFD299; /* Laranja claro */
            --warning-pastel: #FFB74D; /* Laranja um pouco mais forte para badges */
            --danger-pastel: #FF9999; /* Vermelho claro */
            --secondary-pastel: #CBCBCB; /* Cinza claro */
            --text-dark: #34495E; /* Azul escuro para textos principais */
            --text-muted: #7F8C8D; /* Cinza para textos secundários */
            --bg-light: #F8F9FA; /* Fundo geral claro */
            --card-bg: #FFFFFF; /* Fundo dos cards */
            --border-light: #E0E0E0; /* Cor de borda suave */
            --shadow-light: rgba(0, 0, 0, 0.08);
            --shadow-hover: rgba(0, 0, 0, 0.15);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-light);
            color: var(--text-dark);
            line-height: 1.6;
        }

        h1, h2, h3, h4, h5, h6 {
            color: var(--text-dark);
            font-weight: 600;
        }

        .container {
            max-width: 960px;
        }

        header {
            background-color: var(--card-bg);
            padding: 2.5rem 1.5rem;
            margin-bottom: 2rem;
            border-bottom-left-radius: 1.5rem;
            border-bottom-right-radius: 1.5rem;
            box-shadow: 0 5px 15px var(--shadow-light);
            text-align: center;
        }

        header h1 {
            font-size: 2.8rem;
            color: var(--primary-pastel);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.05);
            margin-bottom: 0.5rem;
        }

        header p {
            font-size: 1.1rem;
            color: var(--text-muted);
        }

        .action-bar {
            background-color: var(--card-bg);
            padding: 1.2rem 1.5rem;
            border-radius: 1rem;
            box-shadow: 0 4px 12px var(--shadow-light);
            margin-bottom: 2rem;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 1rem; /* Espaçamento entre os botões */
        }

        .action-bar .btn {
            font-weight: 500;
            padding: 0.8rem 1.5rem;
            border-radius: 0.75rem;
            transition: all 0.2s ease-in-out;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-bar .btn-primary {
            background-color: var(--primary-pastel);
            border-color: var(--primary-pastel);
            color: var(--text-dark);
        }
        .action-bar .btn-primary:hover {
            background-color: #74C0D6; /* Um pouco mais escuro */
            border-color: #74C0D6;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .action-bar .btn-success {
            background-color: var(--success-pastel);
            border-color: var(--success-pastel);
            color: var(--text-dark);
        }
        .action-bar .btn-success:hover {
            background-color: #8FD082; /* Um pouco mais escuro */
            border-color: #8FD082;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .action-bar .btn-info {
            background-color: var(--info-pastel);
            border-color: var(--info-pastel);
            color: var(--text-dark) !important; /* Forçar cor do texto para contraste */
        }
        .action-bar .btn-info:hover {
            background-color: #E6B57E; /* Um pouco mais escuro */
            border-color: #E6B57E;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        /* Ajuste para input de arquivo escondido */
        #jsonFileInput {
            display: none;
        }

        .turma-title {
            color: var(--primary-pastel);
            font-weight: 700;
            font-size: 1.8rem;
            margin-top: 2.5rem;
            margin-bottom: 1.5rem;
            padding-bottom: 0.8rem;
            border-bottom: 3px solid var(--border-light);
            position: relative;
        }
        .turma-title::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -3px; /* Alinha com a borda inferior */
            width: 80px; /* Largura da linha colorida */
            height: 3px;
            background-color: var(--primary-pastel);
            border-radius: 2px;
        }

        .student-card {
            background-color: var(--card-bg);
            border: none;
            border-radius: 1rem;
            box-shadow: 0 4px 15px var(--shadow-light);
            transition: all 0.3s ease-in-out;
            margin-bottom: 1.5rem; /* Espaçamento entre os cards */
        }
        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px var(--shadow-hover);
        }

        .student-card .card-body {
            padding: 1.8rem;
        }

        .student-card .card-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Permite que o badge vá para a linha de baixo se necessário */
            gap: 0.5rem;
        }

        .student-card .card-subtitle {
            font-size: 1rem;
            color: var(--text-muted);
            margin-top: 0.25rem;
        }

        .student-card hr {
            margin: 1.2rem 0;
            border-top: 1px dashed var(--border-light);
        }

        .student-card .card-text {
            font-size: 0.95rem;
            color: var(--text-dark);
            margin-bottom: 0.4rem;
        }
        .student-card .card-text strong {
            color: var(--text-dark);
            min-width: 90px; /* Alinha os dois pontos */
            display: inline-block;
        }

        .student-card .btn-sm {
            padding: 0.5rem 0.6rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease-in-out;
            border-width: 2px; /* Aumenta a borda para dar mais destaque */
        }
        .student-card .btn-outline-primary {
            color: var(--primary-pastel);
            border-color: var(--primary-pastel);
        }
        .student-card .btn-outline-primary:hover {
            background-color: var(--primary-pastel);
            color: white;
        }
        .student-card .btn-outline-danger {
            color: var(--danger-pastel);
            border-color: var(--danger-pastel);
        }
        .student-card .btn-outline-danger:hover {
            background-color: var(--danger-pastel);
            color: white;
        }

        /* Badges de Status */
        .badge {
            font-size: 0.8em;
            padding: 0.4em 0.8em;
            border-radius: 0.5rem;
            font-weight: 600;
            vertical-align: middle;
        }
        .badge.bg-success { background-color: var(--success-pastel) !important; color: var(--text-dark) !important; }
        .badge.bg-warning { background-color: var(--warning-pastel) !important; color: var(--text-dark) !important; }
        .badge.bg-secondary { background-color: var(--secondary-pastel) !important; color: var(--text-dark) !important; }

        /* Placeholder de lista vazia */
        #placeholder {
            font-size: 1.2rem;
            color: var(--text-muted);
            padding: 3rem 0;
            border: 2px dashed var(--border-light);
            border-radius: 1rem;
            background-color: var(--card-bg);
            margin-top: 3rem !important;
        }

        /* Modals */
        .modal-content {
            border-radius: 1rem;
            box-shadow: 0 8px 30px var(--shadow-hover);
            border: none;
        }
        .modal-header {
            background-color: var(--primary-pastel);
            color: var(--text-dark);
            border-top-left-radius: 1rem;
            border-top-right-radius: 1rem;
            padding: 1.5rem;
            border-bottom: none;
        }
        .modal-header .modal-title {
            color: var(--text-dark);
            font-weight: 700;
        }
        .modal-header .btn-close {
            filter: invert(0.5) sepia(1) saturate(5) hue-rotate(175deg) brightness(0.9); /* Adapta o X para a cor do header */
        }
        .modal-body {
            padding: 2rem;
        }
        .modal-footer {
            border-top: 1px solid var(--border-light);
            padding: 1.5rem 2rem;
        }
        .modal-footer .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 500;
        }
        .modal-footer .btn-primary {
            background-color: var(--success-pastel);
            border-color: var(--success-pastel);
            color: var(--text-dark);
        }
        .modal-footer .btn-primary:hover {
            background-color: #8FD082;
            border-color: #8FD082;
        }
        .modal-footer .btn-secondary {
            background-color: var(--secondary-pastel);
            border-color: var(--secondary-pastel);
            color: var(--text-dark);
        }
        .modal-footer .btn-secondary:hover {
            background-color: #B0B0B0;
            border-color: #B0B0B0;
        }
        .modal-footer .btn-danger {
             background-color: var(--danger-pastel);
             border-color: var(--danger-pastel);
             color: var(--text-dark);
        }
        .modal-footer .btn-danger:hover {
            background-color: #E06060;
            border-color: #E06060;
        }

        .form-label {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }
        .form-control, .form-select {
            border-radius: 0.5rem;
            border-color: var(--border-light);
            padding: 0.75rem 1rem;
        }
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-pastel);
            box-shadow: 0 0 0 0.25rem rgba(142, 205, 221, 0.25);
        }

        .feather {
            width: 1.1rem;
            height: 1.1rem;
            vertical-align: -0.125em; /* Ajuste fino para alinhamento */
            stroke-width: 2.5; /* Deixa os ícones um pouco mais grossos */
        }

        /* Responsividade para telas menores */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2rem;
            }
            .action-bar {
                padding: 1rem;
                gap: 0.75rem;
            }
            .action-bar .btn {
                width: 100%; /* Botões ocupam a largura total em telas pequenas */
                justify-content: center;
            }
            .student-card .card-body {
                padding: 1.2rem;
            }
            .student-card .card-title {
                font-size: 1.3rem;
            }
            .turma-title {
                font-size: 1.5rem;
                margin-top: 2rem;
                margin-bottom: 1rem;
            }
        }
    </style>
</head>
<body>

    <div class="container py-4">
        <header>
            <h1>Gerenciador de Alunos</h1>
            <p>Organize e gerencie os dados dos alunos da sua escola infantil.</p>
        </header>

        <!-- Barra de Ações Principais -->
        <div class="action-bar">
            <button class="btn btn-primary" onclick="triggerFileUpload()">
                <i data-feather="folder-plus"></i>Carregar Lista
            </button>
            <input type="file" id="jsonFileInput" accept=".json" onchange="handleFileLoad(event)">
            
            <button class="btn btn-success" onclick="downloadJSON()">
                <i data-feather="download"></i>Baixar Lista
            </button>

            <button class="btn btn-info text-white" onclick="openStudentModal()">
                <i data-feather="plus-circle"></i>Adicionar Aluno
            </button>
        </div>

        <!-- Container para a lista de alunos -->
        <div id="student-list-container">
            <!-- Os cards dos alunos serão inseridos aqui pelo JavaScript -->
        </div>
        <p id="placeholder" class="text-center text-muted mt-5">
            <i data-feather="users" style="width: 3rem; height: 3rem; color: var(--secondary-pastel);"></i><br><br>
            Nenhum aluno na lista. Utilize os botões acima para carregar um arquivo ou adicionar um novo aluno.
        </p>

    </div>

    <!-- Modal para Adicionar/Editar Aluno -->
    <div class="modal fade" id="studentModal" tabindex="-1" aria-labelledby="studentModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="studentModalLabel">Dados do Aluno</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="studentForm">
                        <input type="hidden" id="studentIndex">
                        <div class="mb-3">
                            <label for="nome" class="form-label">Nome Completo</label>
                            <input type="text" class="form-control" id="nome" required>
                        </div>
                        <div class="row">
                             <div class="col-md-7 mb-3">
                                <label for="cpf" class="form-label">CPF do Aluno</label>
                                <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00">
                            </div>
                            <div class="col-md-5 mb-3">
                                <label for="status" class="form-label">Status</label>
                                <select id="status" class="form-select">
                                    <option value="Ativo" selected>Ativo</option>
                                    <option value="Transferido">Transferido</option>
                                    <option value="Inativo">Inativo</option>
                                </select>
                            </div>
                        </div>
                        <hr>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="turma" class="form-label">Turma</label>
                                <input type="text" class="form-control" id="turma" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="turno" class="form-label">Turno</label>
                                <input type="text" class="form-control" id="turno">
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="nascimento" class="form-label">Data de Nascimento</label>
                            <input type="text" class="form-control" id="nascimento" placeholder="dd/mm/aaaa">
                        </div>
                         <div class="mb-3">
                            <label for="mae" class="form-label">Nome da Mãe</label>
                            <input type="text" class="form-control" id="mae">
                        </div>
                         <div class="mb-3">
                            <label for="pai" class="form-label">Nome do Pai</label>
                            <input type="text" class="form-control" id="pai">
                        </div>
                         <div class="mb-3">
                            <label for="telefone" class="form-label">Telefone(s)</label>
                            <input type="text" class="form-control" id="telefone" placeholder="Separe com vírgula: 98..., 99...">
                        </div>
                         <div class="mb-3">
                            <label for="endereco" class="form-label">Endereço</label>
                            <input type="text" class="form-control" id="endereco">
                        </div>
                         <div class="mb-3">
                            <label for="cor" class="form-label">Cor/Raça</label>
                            <input type="text" class="form-control" id="cor">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" onclick="saveStudent()">Salvar</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de Confirmação de Exclusão -->
    <div class="modal fade" id="deleteConfirmModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirmar Exclusão</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p>Você tem certeza que deseja remover este aluno? Esta ação não pode ser desfeita.</p>
            <p class="text-danger fw-bold" id="studentNameToDelete"></p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">Confirmar Exclusão</button>
          </div>
        </div>
      </div>
    </div>


    <!-- Bootstrap 5.3 JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Feather Icons -->
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>

    <script>
        // ===================================================================================
        // VARIÁVEIS GLOBAIS E INICIALIZAÇÃO
        // ===================================================================================
        let students = [];
        let studentModal, deleteModal;

        document.addEventListener('DOMContentLoaded', () => {
            studentModal = new bootstrap.Modal(document.getElementById('studentModal'));
            deleteModal = new bootstrap.Modal(document.getElementById('deleteConfirmModal'));
            loadFromLocalStorage();
            renderStudentList();
            feather.replace(); // Inicializa os Feather Icons
        });


        // ===================================================================================
        // GERENCIAMENTO DE DADOS (LocalStorage, Upload, Download)
        // ===================================================================================

        function saveToLocalStorage() {
            try {
                localStorage.setItem('studentDatabase', JSON.stringify(students));
                console.log('Dados salvos no LocalStorage.');
            } catch (error) {
                console.error('Erro ao salvar no LocalStorage:', error);
                alert('Não foi possível salvar os dados. O armazenamento pode estar cheio.');
            }
        }

        function loadFromLocalStorage() {
            const data = localStorage.getItem('studentDatabase');
            if (data) {
                try {
                    students = JSON.parse(data);
                    console.log('Dados carregados do LocalStorage.');
                } catch (error) {
                    console.error('Erro ao ler dados do LocalStorage:', error);
                    students = [];
                }
            }
        }

        function triggerFileUpload() {
            document.getElementById('jsonFileInput').click();
        }

        function handleFileLoad(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const data = JSON.parse(e.target.result);
                    if (Array.isArray(data)) {
                        students = data;
                        saveAndRender();
                        alert(`${students.length} alunos carregados com sucesso!`);
                    } else {
                        alert('Erro: O arquivo JSON não contém um array de alunos válido.');
                    }
                } catch (error) {
                    alert('Erro ao processar o arquivo. Verifique se é um JSON válido.');
                    console.error(error);
                }
            };
            reader.readAsText(file);
            event.target.value = null; // Limpa o input file para permitir carregar o mesmo arquivo novamente
        }

        function downloadJSON() {
            if (students.length === 0) {
                alert('Não há dados para baixar.');
                return;
            }
            const dataStr = JSON.stringify(students, null, 4);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = 'database_alunos.json';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // ===================================================================================
        // RENDERIZAÇÃO DA LISTA DE ALUNOS
        // ===================================================================================

        function getStatusBadge(status) {
            status = status || 'Ativo'; // Padrão é Ativo se não definido
            const statusColors = {
                'Ativo': 'bg-success',
                'Transferido': 'bg-warning text-dark',
                'Inativo': 'bg-secondary',
            };
            const colorClass = statusColors[status] || 'bg-light text-dark';
            return `<span class="badge ${colorClass}">${status}</span>`;
        }

        function renderStudentList() {
            const container = document.getElementById('student-list-container');
            const placeholder = document.getElementById('placeholder');
            container.innerHTML = '';

            if (students.length === 0) {
                placeholder.style.display = 'block';
                feather.replace(); // Garante que o ícone do placeholder seja renderizado
                return;
            }
            
            placeholder.style.display = 'none';

            const groupedByTurmaTurno = students.reduce((acc, student, index) => {
                const turma = student.turma || 'Sem Turma';
                const turno = student.turno || 'Sem Turno';
                const groupKey = `${turma} - ${turno}`;
                if (!acc[groupKey]) acc[groupKey] = [];
                acc[groupKey].push({ ...student, originalIndex: index });
                return acc;
            }, {});

            const sortedGroups = Object.keys(groupedByTurmaTurno).sort();

            sortedGroups.forEach(groupKey => {
                const groupTitle = document.createElement('h4');
                groupTitle.className = 'turma-title';
                groupTitle.textContent = groupKey;
                container.appendChild(groupTitle);

                groupedByTurmaTurno[groupKey].sort((a, b) => a.nome.localeCompare(b.nome));

                groupedByTurmaTurno[groupKey].forEach(student => {
                    const card = document.createElement('div');
                    card.className = 'card student-card mb-3';
                    card.innerHTML = `
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-start flex-wrap gap-2">
                                <div>
                                    <h5 class="card-title">${student.nome} ${getStatusBadge(student.status)}</h5>
                                </div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-outline-primary" onclick="openStudentModal(${student.originalIndex})">
                                        <i data-feather="edit-2"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-danger" onclick="confirmDelete(${student.originalIndex})">
                                        <i data-feather="trash-2"></i>
                                    </button>
                                </div>
                            </div>
                            <hr>
                            <p class="card-text"><strong>CPF:</strong> ${student.cpf || '---'}</p>
                            <p class="card-text"><strong>Nascimento:</strong> ${student.nascimento || '---'}</p>
                            <p class="card-text"><strong>Mãe:</strong> ${student.mae || '---'}</p>
                            <p class="card-text"><strong>Pai:</strong> ${student.pai || '---'}</p>
                            <p class="card-text"><strong>Telefone:</strong> ${student.telefone && student.telefone.length ? student.telefone.join(', ') : '---'}</p>
                            <p class="card-text"><strong>Endereço:</strong> ${student.endereco || '---'}</p>
                            <p class="card-text"><strong>Cor/Raça:</strong> ${student.cor || '---'}</p>
                        </div>
                    `;
                    container.appendChild(card);
                });
            });

            feather.replace(); // Atualiza os ícones após a renderização dos cards
        }


        // ===================================================================================
        // LÓGICA DO MODAL E CRUD (Create, Read, Update, Delete)
        // ===================================================================================

        function openStudentModal(index = null) {
            const form = document.getElementById('studentForm');
            form.reset();

            const modalTitle = document.getElementById('studentModalLabel');
            const studentIndexInput = document.getElementById('studentIndex');

            if (index !== null) {
                // Modo Edição
                modalTitle.textContent = 'Editar Dados do Aluno';
                const student = students[index];
                studentIndexInput.value = index;
                document.getElementById('nome').value = student.nome;
                document.getElementById('cpf').value = student.cpf || '';
                document.getElementById('status').value = student.status || 'Ativo';
                document.getElementById('turma').value = student.turma;
                document.getElementById('turno').value = student.turno || '';
                document.getElementById('nascimento').value = student.nascimento || '';
                document.getElementById('mae').value = student.mae || '';
                document.getElementById('pai').value = student.pai || '';
                document.getElementById('telefone').value = student.telefone ? student.telefone.join(', ') : '';
                document.getElementById('endereco').value = student.endereco || '';
                document.getElementById('cor').value = student.cor || '';
            } else {
                // Modo Adição
                modalTitle.textContent = 'Adicionar Novo Aluno';
                studentIndexInput.value = '';
                document.getElementById('status').value = 'Ativo'; // Padrão para novos alunos
            }

            studentModal.show();
        }

        function saveStudent() {
            const index = document.getElementById('studentIndex').value;
            
            const telefones = document.getElementById('telefone').value.split(',')
                .map(t => t.trim())
                .filter(t => t);

            const studentData = {
                nome: document.getElementById('nome').value,
                cpf: document.getElementById('cpf').value,
                status: document.getElementById('status').value,
                turma: document.getElementById('turma').value,
                turno: document.getElementById('turno').value,
                nascimento: document.getElementById('nascimento').value,
                mae: document.getElementById('mae').value,
                pai: document.getElementById('pai').value,
                telefone: telefones,
                endereco: document.getElementById('endereco').value,
                cor: document.getElementById('cor').value,
            };

            if (!studentData.nome || !studentData.turma) {
                alert('Os campos "Nome Completo" e "Turma" são obrigatórios.');
                return;
            }

            if (index !== '') { // Use !== '' para verificar se é um índice válido
                students[index] = studentData;
            } else {
                students.push(studentData);
            }

            saveAndRender();
            studentModal.hide();
        }

        function confirmDelete(index) {
            const student = students[index];
            document.getElementById('studentNameToDelete').textContent = student.nome;
            
            const confirmBtn = document.getElementById('confirmDeleteBtn');
            // Remove o listener anterior para evitar múltiplos binds
            const newConfirmBtn = confirmBtn.cloneNode(true);
            newConfirmBtn.addEventListener('click', () => {
                deleteStudent(index);
                deleteModal.hide(); // Fecha o modal após a exclusão
            });
            confirmBtn.replaceWith(newConfirmBtn);

            deleteModal.show();
        }

        function deleteStudent(index) {
            students.splice(index, 1);
            saveAndRender();
        }
        
        function saveAndRender() {
            saveToLocalStorage();
            renderStudentList();
        }
    </script>
</body>
</html>